# KrishiMitra Knowledge Base (FAQ)
# This file contains curated farming questions and answers for instant chatbot responses.
# Add more Q&A pairs as needed.

FAQ = [
    # Wheat
    {
        "question_keywords": ["best fertilizer for wheat", "wheat fertilizer", "NPK for wheat", "wheat nutrient management"],
        "answer": "For wheat, use 120 kg Nitrogen, 60 kg Phosphorus, and 40 kg Potassium per hectare. Apply 40% N and all P & K at sowing, then split the rest of N during tillering and booting stages."
    },
    {
        "question_keywords": ["soil for wheat", "best soil for wheat", "wheat soil type", "which soil type required for wheat", "wheat soil requirements"],
        "answer": "Wheat grows best in well-drained loam or clay-loam soils with good fertility and moderate water-holding capacity. pH should be 6.0-7.5. Avoid saline or highly acidic soils for optimal yield."
    },
    {
        "question_keywords": ["best wheat variety", "wheat seeds", "wheat high yield", "disease resistant wheat"],
        "answer": "HD-2967 and DBW-17 are high-yielding wheat varieties with good resistance to rust and smut. Choose based on local climate and disease history."
    },
    {
        "question_keywords": ["wheat pest management", "wheat rust", "wheat aphid", "wheat disease"],
        "answer": "Scout for rusts and aphids. Use resistant varieties, timely fungicide sprays, and maintain field hygiene. Remove infected leaves and avoid excessive irrigation."
    },
    # Rice
    {
        "question_keywords": ["best fertilizer for rice", "rice fertilizer", "NPK for rice", "rice nutrient management"],
        "answer": "For rice, use 150 kg Nitrogen, 60 kg Phosphorus, and 40 kg Potassium per hectare. Apply 50% N and all P & K at transplanting, then split the rest of N during tillering and panicle initiation."
    },
    {
        "question_keywords": ["best rice variety", "rice seeds", "rice high yield", "disease resistant rice"],
        "answer": "Pusa-44 and HKR-47 are high-yielding rice varieties with good resistance to blast and bacterial blight. Choose based on local climate and water availability."
    },
    {
        "question_keywords": ["rice pest management", "rice stem borer", "brown planthopper", "rice disease"],
        "answer": "Scout for stem borer and brown planthopper. Use pheromone traps, recommended insecticides, and avoid excessive nitrogen. Maintain field hygiene and water management."
    },
    {
        "question_keywords": ["soil for rice", "best soil for rice", "rice soil type", "which soil type required for rice", "rice soil requirements"],
        "answer": "Rice grows best in clay or clay-loam soils with good water retention capacity. Waterlogged conditions are suitable. pH should be 5.5-7.0. Avoid sandy soils with poor water retention."
    },
    # Maize
    {
        "question_keywords": ["best fertilizer for maize", "maize fertilizer", "NPK for maize", "maize nutrient management"],
        "answer": "For maize, use 120 kg Nitrogen, 60 kg Phosphorus, and 40 kg Potassium per hectare. Apply half N and all P & K at sowing, then split the rest of N during vegetative and tasseling stages."
    },
    {
        "question_keywords": ["best maize variety", "maize seeds", "maize high yield", "disease resistant maize"],
        "answer": "HQPM-1 and HM-4 are high-yielding maize hybrids with good resistance to common diseases. Choose based on local climate and market demand."
    },
    {
        "question_keywords": ["maize pest management", "maize stem borer", "maize disease"],
        "answer": "Scout for stem borer and leaf blight. Use resistant varieties, timely insecticide sprays, and crop rotation. Remove infected plants and maintain field hygiene."
    },
    {
        "question_keywords": ["soil for maize", "best soil for maize", "maize soil type", "which soil type required for maize", "maize soil requirements"],
        "answer": "Maize grows best in well-drained loamy soils with good organic matter. Sandy loam and clay loam soils with pH 6.0-7.5 are ideal. Ensure good drainage and avoid waterlogged or highly acidic soils."
    },
    # Cotton
    {
        "question_keywords": ["best fertilizer for cotton", "cotton fertilizer", "NPK for cotton", "cotton nutrient management"],
        "answer": "For cotton, use 150 kg Nitrogen, 60 kg Phosphorus, and 60 kg Potassium per hectare. Apply half N and all P & K at sowing, then split the rest of N during flowering and boll formation."
    },
    {
        "question_keywords": ["best cotton variety", "cotton seeds", "cotton high yield", "disease resistant cotton"],
        "answer": "Bt Cotton hybrids are high-yielding and resistant to bollworm. Choose based on local climate and pest history."
    },
    {
        "question_keywords": ["cotton pest management", "cotton bollworm", "cotton whitefly", "cotton disease"],
        "answer": "Scout for bollworm and whitefly. Use pheromone traps, recommended insecticides, and maintain field hygiene. Remove infested bolls and avoid waterlogging."
    },
    {
        "question_keywords": ["soil for cotton", "best soil for cotton", "cotton soil type", "what type of soil should be used for cotton", "cotton soil requirements"],
        "answer": "Cotton grows best in deep, well-drained black cotton soil (vertisols) with good water retention. Sandy loam and clay loam soils with pH 5.8-8.0 are also suitable. Avoid waterlogged or highly saline soils."
    },
    # Sugarcane
    {
        "question_keywords": ["best fertilizer for sugarcane", "sugarcane fertilizer", "NPK for sugarcane", "sugarcane nutrient management"],
        "answer": "For sugarcane, use 150 kg Nitrogen, 60 kg Phosphorus, and 60 kg Potassium per hectare. Apply half N and all P & K at planting, then split the rest of N during grand growth stage."
    },
    {
        "question_keywords": ["best sugarcane variety", "sugarcane seeds", "sugarcane high yield", "disease resistant sugarcane"],
        "answer": "Co-0238 and Co-86032 are high-yielding sugarcane varieties with good resistance to red rot. Choose based on local climate and disease history."
    },
    {
        "question_keywords": ["sugarcane pest management", "sugarcane early shoot borer", "sugarcane disease"],
        "answer": "Scout for early shoot borer and red rot. Use resistant varieties, timely insecticide sprays, and maintain field hygiene. Remove infected shoots and avoid excessive irrigation."
    },
    {
        "question_keywords": ["soil for sugarcane", "best soil for sugarcane", "sugarcane soil type", "which soil type to be used for sugarcane", "which soil type to use for growing sugarcane", "sugarcane soil requirements"],
        "answer": "Sugarcane grows best in deep, well-drained loamy soils with good water retention. Clay loam and sandy loam soils with pH 6.0-7.5 are ideal. Avoid waterlogged, saline, or highly acidic soils."
    },
    # Pulses
    {
        "question_keywords": ["best fertilizer for pulses", "pulses fertilizer", "NPK for pulses", "pulses nutrient management"],
        "answer": "For pulses, use 20 kg Nitrogen, 40 kg Phosphorus, and 20 kg Potassium per hectare. Apply all fertilizers at sowing. Use Rhizobium inoculation for better nitrogen fixation."
    },
    {
        "question_keywords": ["best pulse variety", "pulse seeds", "pulse high yield", "disease resistant pulses"],
        "answer": "Pusa-372 (mungbean) and Pusa-16 (lentil) are high-yielding pulse varieties. Choose based on local climate and disease history."
    },
    {
        "question_keywords": ["pulse pest management", "pulse pod borer", "pulse disease"],
        "answer": "Scout for pod borer and wilt. Use resistant varieties, timely insecticide sprays, and crop rotation. Remove infected plants and maintain field hygiene."
    },
    # Oilseeds
    {
        "question_keywords": ["best fertilizer for oilseeds", "oilseeds fertilizer", "NPK for oilseeds", "oilseeds nutrient management"],
        "answer": "For oilseeds, use 40 kg Nitrogen, 40 kg Phosphorus, and 40 kg Potassium per hectare. Apply all fertilizers at sowing. Use sulfur for better oil content."
    },
    {
        "question_keywords": ["best oilseed variety", "oilseed seeds", "oilseed high yield", "disease resistant oilseeds"],
        "answer": "Pusa Bold (mustard) and JS-335 (soybean) are high-yielding oilseed varieties. Choose based on local climate and market demand."
    },
    {
        "question_keywords": ["oilseed pest management", "oilseed aphid", "oilseed disease"],
        "answer": "Scout for aphids and alternaria blight. Use resistant varieties, timely insecticide sprays, and crop rotation. Remove infected plants and maintain field hygiene."
    },
    # Vegetables
    {
        "question_keywords": ["best fertilizer for vegetables", "vegetable fertilizer", "NPK for vegetables", "vegetable nutrient management"],
        "answer": "For vegetables, use 50-100 kg Nitrogen, 50 kg Phosphorus, and 50 kg Potassium per hectare. Apply half N and all P & K at sowing, then split the rest of N during vegetative and flowering stages."
    },
    {
        "question_keywords": ["best vegetable variety", "vegetable seeds", "vegetable high yield", "disease resistant vegetables"],
        "answer": "Pusa Hybrid-1 (tomato), Arka Anamika (okra), and Pusa Chetki (radish) are high-yielding vegetable varieties. Choose based on local climate and market demand."
    },
    {
        "question_keywords": ["vegetable pest management", "vegetable fruit borer", "vegetable disease"],
        "answer": "Scout for fruit borer and powdery mildew. Use resistant varieties, timely insecticide sprays, and crop rotation. Remove infected fruits and maintain field hygiene."
    },
    # General farming
    {
        "question_keywords": ["drip irrigation benefits", "irrigation methods", "how to irrigate", "water saving techniques"],
        "answer": "Drip irrigation saves water, improves yield, and reduces weed growth. It is ideal for vegetables, fruits, and row crops. Regularly check emitters for clogging."
    },
    {
        "question_keywords": ["how to increase soil health", "improve soil fertility", "soil management", "organic matter"],
        "answer": "Add organic matter like compost and manure, practice crop rotation, and avoid excessive chemical fertilizers. Test soil regularly for nutrient status."
    },
    {
        "question_keywords": ["PM-KISAN scheme", "government support for farmers", "income support", "farmer scheme"],
        "answer": "PM-KISAN provides Rs. 6000 per year to eligible farmers. Apply online at the PM-KISAN portal. Eligibility: small and marginal farmers with up to 2 hectares of land."
    },
    {
        "question_keywords": ["crop insurance", "Fasal Bima Yojana", "protect crops from calamities", "insurance for crops"],
        "answer": "PM Fasal Bima Yojana offers crop insurance against natural calamities. Apply through banks or insurance companies. Coverage up to 100% of sum insured."
    },
    {
        "question_keywords": ["Kisan Credit Card", "farm loan", "agriculture loan", "credit for farmers"],
        "answer": "Kisan Credit Card provides credit facility up to Rs. 3 lakhs for farmers. Apply through banks or cooperative societies. Maintain good credit history for eligibility."
    },
]

def get_faq_answer(user_question: str) -> str:
    """Enhanced FAQ matching with better keyword scoring"""
    lower_q = user_question.lower()
    best_match = None
    best_score = 0
    
    for faq in FAQ:
        score = 0
        for kw in faq["question_keywords"]:
            if kw in lower_q:
                # Give higher score for longer, more specific matches
                score += len(kw.split())
        
        if score > best_score:
            best_score = score
            best_match = faq["answer"]
    
    return best_match or ""
